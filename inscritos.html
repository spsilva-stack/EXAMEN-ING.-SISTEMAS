<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Inscritos - Academia de Idiomas</title>

  <!-- Bootstrap -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

  <!-- Estilos personalizados -->
  <link rel="stylesheet" href="css/style.css">
</head>
<body>

  <!-- NAVBAR -->
  <nav class="navbar navbar-expand-lg navbar-dark fixed-top shadow">
    <div class="container">
      <a class="navbar-brand fw-bold" href="index.html">游깴 Academia de Idiomas</a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarNav">
        <ul class="navbar-nav ms-auto">
          <li class="nav-item"><a class="nav-link" href="index.html">Inicio</a></li>
          <li class="nav-item"><a class="nav-link" href="cursos.html">Cursos</a></li>
          <li class="nav-item"><a class="nav-link" href="inscripcion.html">Inscripci칩n</a></li>
          <li class="nav-item"><a class="nav-link active" href="inscritos.html">Inscritos</a></li>
        </ul>
      </div>
    </div>
  </nav>

  <!-- LISTA DE INSCRITOS -->
  <main class="container my-5">
    <div class="table-section shadow">
      <h2 class="text-center mb-4">游늶 Lista de Inscritos</h2>

      <!-- Contador y botones -->
      <div class="d-flex justify-content-between align-items-center mb-3">
        <span class="badge bg-primary p-2 fs-6">Total inscritos: <span id="totalInscritos">0</span></span>
        <div>
          <button class="btn btn-success btn-sm me-2" id="btnExportExcel">游늵 Exportar a Excel</button>
          <button class="btn btn-danger btn-sm" id="btnExportPDF">游늯 Exportar a PDF</button>
        </div>
      </div>

      <!-- Tabla de inscritos -->
      <div class="table-responsive">
        <table class="table table-striped table-hover align-middle" id="tablaInscritos">
          <thead class="table-dark text-center">
            <tr>
              <th>Nombre</th>
              <th>Correo</th>
              <th>Curso</th>
              <th>Nivel</th>
              <th>Horario</th>
              <th>Modalidad</th>
              <th>Acci칩n</th>
            </tr>
          </thead>
          <tbody>
            <!-- Los inscritos se cargar치n din치micamente desde main.js -->
          </tbody>
        </table>
      </div>
    </div>
  </main>

  <!-- FOOTER -->
  <footer class="text-center py-4 mt-5">
    <p class="mb-0">춸 2025 Academia de Idiomas | Todos los derechos reservados</p>
   <p>游닎 info@academiaidiomas.com</p>
  </footer>

  <!-- Scripts -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
  <!-- Librer칤a jsPDF -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <!-- Librer칤a XLSX para exportar a Excel -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <!-- Script principal -->
  <script src="js/main.js"></script>

  <!-- Script de exportaci칩n -->
  <script>
    document.addEventListener("DOMContentLoaded", function () {
      // 游늯 Exportar a PDF
      const btnPDF = document.getElementById("btnExportPDF");
      if (btnPDF) {
        btnPDF.addEventListener("click", () => {
          const { jsPDF } = window.jspdf;
          const doc = new jsPDF();

          doc.setFontSize(16);
          doc.text("游늶 Lista de Inscritos - Academia de Idiomas", 20, 20);

          let inscritos = JSON.parse(localStorage.getItem("inscritos")) || [];
          let y = 40;
          doc.setFontSize(10);
          inscritos.forEach((i, index) => {
            doc.text(
              `${index + 1}. ${i.nombre} | ${i.email} | ${i.curso} | ${i.nivel} | ${i.horario} | ${i.modalidad}`,
              20,
              y
            );
            y += 8;
            if (y > 270) {
              doc.addPage();
              y = 20;
            }
          });

          doc.save("Lista_Inscritos.pdf");
        });
      }

      // 游늵 Exportar a Excel
      const btnExcel = document.getElementById("btnExportExcel");
      if (btnExcel) {
        btnExcel.addEventListener("click", () => {
          let inscritos = JSON.parse(localStorage.getItem("inscritos")) || [];
          if (inscritos.length === 0) {
            alert("丘멆잺 No hay datos para exportar.");
            return;
          }

          const ws = XLSX.utils.json_to_sheet(inscritos);
          const wb = XLSX.utils.book_new();
          XLSX.utils.book_append_sheet(wb, ws, "Inscritos");
          XLSX.writeFile(wb, "Lista_Inscritos.xlsx");
        });
      }
    });
  </script>
</body>
</html>


